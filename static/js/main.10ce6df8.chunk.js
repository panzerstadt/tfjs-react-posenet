(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports={loading:"Posenet_loading__3_Gk5",posenet:"Posenet_posenet__3mPFo",download:"Posenet_download__3Ba3B",button:"Posenet_button__SsefG",contextualOptions:"Posenet_contextualOptions__3IWp1",contextualOptionsDiv:"Posenet_contextualOptionsDiv__3A6kY",replayDiv:"Posenet_replayDiv__3rekZ",scrubberDiv:"Posenet_scrubberDiv__1y8W_",scrubberInnerDiv:"Posenet_scrubberInnerDiv__3ywqU"}},161:function(e,t,a){e.exports={sliderScrubber:"SliderScrubber_sliderScrubber__2PdqC"}},163:function(e,t,a){e.exports=a(391)},168:function(e,t,a){},170:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},171:function(e,t,a){},179:function(e,t){},181:function(e,t){},214:function(e,t){},215:function(e,t){},387:function(e,t,a){},391:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(157),i=a.n(r),s=(a(168),a(23)),c=a(24),l=a(27),d=a(25),u=a(26),h=a(3),f=(a(170),a(171),a(8)),p=a.n(f),g=a(20),m=a(5),v=a.n(m),b=a(15),k=a(49),w=a(158),y=a.n(w),C=(a(159),a(12)),O=a.n(C);function j(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"undefined"!=typeof t[e.toLowerCase()]&&t[e.toLowerCase()]}var _=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1?arguments[1]:void 0,a=_(t),n=_("#333333");return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(g.a)(Array(e)).map(function(n,o){return(1-(r=o/e))*a+r*t;var r})}(e).map(function(e){return"#"+((1<<24)+((t=function(e,t,a){arguments.length<3&&(a=.5);for(var n=e.slice(),o=0;o<3;o++)n[o]=Math.round(n[o]+a*(t[o]-e[o]));return n}(a,n,e))[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1);var t}).reverse()},x=a(99),S=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},R=function(e,t,a,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.forEach(function(e){if(e.score>=t){var r=e.position,i=r.y,s=r.x;n.beginPath(),n.arc(s*o,i*o,3,0,2*Math.PI),n.fillStyle=a,n.fill()}})},E=function(e){return[e.y,e.x]},V=function(e,t,a,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;k.a(e,t).forEach(function(e){!function(e,t,a,n,o,r){var i=Object(x.a)(e,2),s=i[0],c=i[1],l=Object(x.a)(t,2),d=l[0],u=l[1];r.beginPath(),r.moveTo(c*o,s*o),r.lineTo(u*o,d*o),r.lineWidth=n,r.strokeStyle=a,r.stroke()}(E(e[0].position),E(e[1].position),a,n,r,o)})},D=a(160),A=a.n(D),T=a(161),F=a.n(T),N=(a(385),a(387),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={value:{min:10,max:50},valueOld:{min:10,max:50,diff:0},snap:!0},a.onChangeStart=a.onChangeStart.bind(Object(h.a)(Object(h.a)(a))),a.onChangeComplete=a.onChangeComplete.bind(Object(h.a)(Object(h.a)(a))),a.onChange=a.onChange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onChangeStart",value:function(e){var t={min:e.min,max:e.max,diff:e.max-e.min};this.setState({valueOld:t})}},{key:"onChangeComplete",value:function(e){if(this.state.valueOld.min===e.min){var t={min:e.max-this.state.valueOld.diff,max:e.max};this.setState({value:t})}this.props.onChangeComplete&&this.props.onChangeComplete(e)}},{key:"onChange",value:function(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.props.range,t=e&&e.min||0,a=e&&(e.max||e)||100;Math.min(Math.max(this.state.value.min,t),a-20),Math.min(this.state.value.max,a);return o.a.createElement("div",{className:F.a.sliderScrubber},o.a.createElement(A.a,{draggableTrack:!0,maxValue:a,minValue:t,onChange:this.onChange,onChangeStart:this.onChangeStart,onChangeComplete:this.onChangeComplete,value:this.state.value}))}}]),t}(n.Component)),W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json.txt",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain",n=document.createElement("a"),o=new Blob([e],{type:a});n.href=URL.createObjectURL(o),n.download=t,n.click()},M=a(162),L={subject:"subject_value",message:"message_value",from:"from_value"},I=function(){var e=Object(b.a)(v.a.mark(function e(t){var a,n,o,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.subject,n=t.message,o=t.from,r={subject:a,message:n,from:o},e.abrupt("return",new Promise(function(e){M.send("default_service","posenet",r||L,"user_ljTfIJFviZGfuGmui594C").then(function(t){console.log("SUCCESS!",t.status,t.text),e(!0)},function(t){console.log("FAILED...",t),e(!1)})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),B="#5FD49B",q="#FF8547",H=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!0,error_messages:"",stream:null,trace:[],frames:[]},a.camera=void 0,a.traceVideo=a.traceVideo.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a.getVideo=function(e){a.video=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=Object(b.a)(v.a.mark(function e(t,a){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this.props){e.next=8;break}if(t.frontCamera===this.props.frontCamera){e.next=8;break}return this.stopCamera(),e.next=5,this.setupCamera();case 5:this.camera=e.sent,this.startCamera(),this.detectPose();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"errorMessages",value:function(){this.props.errorMessages&&this.props.errorMessages(this.state.error_messages)}},{key:"getPoseRecords",value:function(){this.props.getPoseRecords&&this.props.getPoseRecords(this.state.trace)}},{key:"getVideoRecords",value:function(){this.props.getVideoRecords&&this.props.getVideoRecords(this.state.frames)}},{key:"tracePose",value:function(e){this.props.record&&this.setState({trace:[].concat(Object(g.a)(this.state.trace),Object(g.a)(e))})}},{key:"traceVideo",value:function(e){this.props.record&&this.setState({frames:[].concat(Object(g.a)(this.state.frames),[e])})}},{key:"stopCamera",value:function(){var e=this.camera;e&&(e.srcObject.getTracks().map(function(e){return e.stop()}),this.camera=void 0,this.setState({loading:!0,stop:!0}))}},{key:"startCamera",value:function(){this.camera?this.setState({loading:!1,stop:!1}):this.stopCamera()}},{key:"setupCamera",value:function(){var e=Object(b.a)(v.a.mark(function e(){var t,a,n,o,r,i,s,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=4;break}throw t="Browser API navigator.mediaDevices.getUserMedia not available",this.setState({error_messages:t}),t;case 4:return a=this.props,n=a.videoWidth,o=a.videoHeight,r=this.video,i=S(),s=this.props.frontCamera,r.width=n,r.height=o,e.next=12,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:s?"user":{exact:"environment"},width:i?void 0:n,height:i?void 0:o}});case 12:return c=e.sent,r.srcObject=c,e.abrupt("return",new Promise(function(e){r.onloadedmetadata=function(){r.play(),e(r)}}));case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"detectPose",value:function(){var e=this.props,t=e.videoWidth,a=e.videoHeight,n=this.canvas,o=n.getContext("2d");n.width=t,n.height=a,this.poseDetectionFrame(o)}},{key:"poseDetectionFrame",value:function(e){var t=this,a=this.props,n=a.algorithm,o=a.imageScaleFactor,r=a.forceFlipHorizontal,i=a.outputStride,s=a.minPoseConfidence,c=a.maxPoseDetections,l=a.minPartConfidence,d=a.nmsRadius,u=a.videoWidth,h=a.videoHeight,f=a.showVideo,p=a.showPoints,g=a.showSkeleton,m=a.skeletonColor,k=a.skeletonLineWidth,w=a.frontCamera,y=a.stop,C=this.net,O=this.video,j=r||!!w,_=function(){var a=Object(b.a)(v.a.mark(function a(){var r,b;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=[],a.t0=n,a.next="single-pose"===a.t0?4:"multi-pose"===a.t0?9:13;break;case 4:return a.next=6,C.estimateSinglePose(O,o,j,i);case 6:return b=a.sent,r.push(b),a.abrupt("break",13);case 9:return a.next=11,C.estimateMultiplePoses(O,o,j,i,c,l,d);case 11:return r=a.sent,a.abrupt("break",13);case 13:e.clearRect(0,0,u,h),f&&(e.save(),j&&(e.scale(-1,1),e.translate(-u,0)),e.drawImage(O,0,0,u,h),e.restore()),r.forEach(function(t){var a=t.score,n=t.keypoints;a>=s&&(p&&R(n,l,m,e),g&&V(n,l,m,k,e))}),y||t.state.stop||!t.camera?(console.log("stopping function"),e.clearRect(0,0,u,h)):(t.props.record&&(t.props.recordVideo?console.log("recording frame and video!"):console.log("recording frames!"),t.tracePose(r),t.canvas.toBlob(t.traceVideo,"image/jpeg",.4),t.getPoseRecords(),t.getVideoRecords()),requestAnimationFrame(_));case 17:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();_()}},{key:"componentDidMount",value:function(){var e=Object(b.a)(v.a.mark(function e(){var t;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b(this.props.mobileNetArchitecture);case 2:return this.net=e.sent,e.prev=3,e.next=6,this.setupCamera();case 6:this.camera=e.sent,e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(3),t="This browser does not support video capture, or this device does not have a camera",this.setState({error_messages:t}),t;case 14:return e.prev=14,this.setState({loading:!1}),e.finish(14);case 17:this.detectPose();case 18:case"end":return e.stop()}},e,this,[[3,9,14,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("component will unmounts!"),this.stopCamera(),this.setState({stop:!0})}},{key:"render",value:function(){var e=this.state.loading?o.a.createElement("div",{className:O.a.loading},o.a.createElement("code",null,this.props.loadingText),o.a.createElement("br",null),o.a.createElement("code",{style:{color:"red",fontSize:12}},this.state.error_messages)):"";return this.errorMessages(),o.a.createElement("div",{className:O.a.posenet},e,o.a.createElement("video",{playsInline:!0,ref:this.getVideo}),o.a.createElement("canvas",{ref:this.getCanvas}))}}]),t}(n.Component);H.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:10,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1,recordVideo:!1};var U=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={loadedPoseRecords:[],loadedPoseVideo:[]},a.onChange=a.onChange.bind(Object(h.a)(Object(h.a)(a))),a.loadData=a.loadData.bind(Object(h.a)(Object(h.a)(a))),a.handleFileRead=a.handleFileRead.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"drawPose",value:function(e){var t=this.props,a=t.videoWidth,n=t.videoHeight,o=this.canvas,r=o.getContext("2d");o.width=a,o.height=n,this.poseDrawFrame(r,e)}},{key:"poseDrawFrame",value:function(e,t){var a=this.props,n=a.minPoseConfidence,o=a.minPartConfidence,r=a.videoWidth,i=a.videoHeight,s=a.showPoints,c=a.showSkeleton,l=a.skeletonColor,d=a.skeletonLineWidth,u=a.showVideo,h=a.flipped,f=this.props,p=f.poseRecords,g=f.poseVideo;0===p.length&&this.state.loadedPoseRecords.length>1&&(p=this.state.loadedPoseRecords),0===g.length&&this.state.loadedPoseVideo.length>1&&(g=this.state.loadedPoseVideo),requestAnimationFrame(function(){var a=Object(b.a)(v.a.mark(function a(){var f,m,b,k,w,y,C,O;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:f=function(){m.map(function(t,a){var r=t.score,i=t.keypoints;r>=n&&(s&&R(i,o,y[a],e),c&&V(i,o,y[a],d,e))})},m=[],m=t?p.slice(t.min,t.max):p,b=[],t?(m=p.slice(t.min,t.max),g&&(b=g.slice(t.min,t.max))):(m=p,g&&(b=g)),b=b[b.length-1],k=m.length,w=j(l)||"#cccccc",(y=P(k,w)).reverse()[0]="#fff",y.reverse(),u&&g.length>1&&m.length>1?(C=document.createElement("img"),O=URL.createObjectURL(b),C.src=O,C.onload=function(){e.clearRect(0,0,r,i),e.save(),h&&(e.scale(-1,1),e.translate(-r,0)),e.drawImage(C,0,0,r,i),e.restore(),f(),URL.revokeObjectURL(O)}):(e.clearRect(0,0,r,i),f());case 12:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}())}},{key:"componentDidMount",value:function(){this.drawPose()}},{key:"onChange",value:function(e){this.drawPose(e)}},{key:"handleFileRead",value:function(e){var t=JSON.parse(this.fileReader.result);this.setState({loadedPoseRecords:t.poseRecords||t||[],loadedPoseVideo:t.poseVideo||[]})}},{key:"loadData",value:function(e){this.fileReader=new FileReader,this.fileReader.onloadend=this.handleFileRead,this.fileReader.readAsText(e.target.files[0])}},{key:"render",value:function(){var e=this,t=this.props,a=t.poseRecords,n=t.poseVideo;0===a.length&&this.state.loadedPoseRecords.length>1&&(a=this.state.loadedPoseRecords),0===n.length&&this.state.loadedPoseVideo.length>1&&(n=this.state.loadedPoseVideo);var r=o.a.createElement("div",{className:O.a.contextualOptionsDiv},o.a.createElement("div",{className:O.a.contextualOptions},a.length>1?o.a.createElement("div",null,o.a.createElement("div",{className:O.a.download,style:{maxWidth:800,margin:"0 auto",display:"flex"}},o.a.createElement("button",{className:O.a.button,onClick:function(){return W(JSON.stringify({poseRecords:a,poseVideo:[]}),"temp.json")}},"download data"),o.a.createElement("button",{className:O.a.button,onClick:Object(b.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I({subject:"GWARA GWARA!",message:"I challenge you! GAWRRR!",from:"Rahmat Hidayat"});case 2:alert("challenge sent!");case 3:case"end":return e.stop()}},e,this)}))},"send challenge"),o.a.createElement("button",{className:O.a.button,onClick:function(){return console.log("clearing records!"),e.setState({loadedPoseRecords:[],loadedPoseVideo:[]})}},"clear data"))):o.a.createElement("div",{className:O.a.download,style:{maxWidth:800,padding:"10px 0",margin:"0 auto"}},o.a.createElement("input",{type:"file",name:"pose records upload",accept:".json",onChange:this.loadData}))));return o.a.createElement("div",{className:O.a.replayDiv},o.a.createElement("div",{style:{backgroundColor:"#050517",maxWidth:800,overflow:"hidden",height:"100vh"}},o.a.createElement("div",null,o.a.createElement("canvas",{ref:this.getCanvas}))),o.a.createElement("div",{className:O.a.scrubberDiv},o.a.createElement("div",{className:O.a.scrubberInnerDiv},o.a.createElement(N,{onChange:this.onChange,range:a.length}))),this.props.additionalOptions?r:"","")}}]),t}(n.Component);U.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1,additionalOptions:!0};var G=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!0,error_messages:"",stream:null,trace:[],frames:[],height:0,width:0},a.traceVideo=a.traceVideo.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a.getVideo=function(e){a.video=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"tracePose",value:function(e){this.props.record&&this.setState({trace:[].concat(Object(g.a)(this.state.trace),Object(g.a)(e))})}},{key:"traceVideo",value:function(e){this.props.record&&this.setState({frames:[].concat(Object(g.a)(this.state.frames),[e])})}},{key:"onStream",value:function(e){console.log("streaming data"),console.log(e)}},{key:"setDims",value:function(e,t){this.setState({height:e,width:t})}},{key:"detectPose",value:function(){var e=this.state,t=e.width,a=e.height,n=this.canvas,o=n.getContext("2d");n.width=t,n.height=a,this.poseDetectionFrame(o)}},{key:"poseDetectionFrame",value:function(e){var t=this,a=this.props,n=a.algorithm,o=a.imageScaleFactor,r=a.forceFlipHorizontal,i=a.outputStride,s=a.minPoseConfidence,c=a.maxPoseDetections,l=a.minPartConfidence,d=a.nmsRadius,u=a.videoWidth,h=a.videoHeight,f=a.showVideo,p=a.showPoints,g=a.showSkeleton,m=a.skeletonColor,k=a.skeletonLineWidth,w=a.frontCamera,y=a.stop,C=this.net,O=this.video,j=r||!!w,_=function(){var a=Object(b.a)(v.a.mark(function a(){var r,b;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=[],a.t0=n,a.next="single-pose"===a.t0?4:"multi-pose"===a.t0?9:13;break;case 4:return a.next=6,C.estimateSinglePose(O,o,j,i);case 6:return b=a.sent,r.push(b),a.abrupt("break",13);case 9:return a.next=11,C.estimateMultiplePoses(O,o,j,i,c,l,d);case 11:return r=a.sent,a.abrupt("break",13);case 13:e.clearRect(0,0,u,h),f&&(e.save(),j&&(e.scale(-1,1),e.translate(-u,0)),e.drawImage(O,0,0,u,h),e.restore()),r.forEach(function(t){var a=t.score,n=t.keypoints;a>=s&&(p&&R(n,l,m,e),g&&V(n,l,m,k,e))}),y||t.state.stop||!t.camera?(console.log("stopping function"),e.clearRect(0,0,u,h)):(t.props.record&&(t.props.recordVideo,t.tracePose(r),t.canvas.toBlob(t.traceVideo,"image/jpeg",.4),t.getPoseRecords(),t.getVideoRecords()),requestAnimationFrame(_));case 17:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();_()}},{key:"onCameraStart",value:function(){var e=Object(b.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getVideoTracks()[0].getSettings(),e.next=3,k.b(this.props.mobileNetArchitecture);case 3:this.net=e.sent,this.setDims(a.height,a.width),this.onStream(t),this.detectPose();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=window.innerWidth,t=window.innerHeight;return o.a.createElement("div",null,o.a.createElement("p",null,"match"),o.a.createElement("p",null,"width: ",e),o.a.createElement("p",null,"height: ",t),o.a.createElement(y.a,null),o.a.createElement("canvas",{ref:this.getCanvas}))}}]),t}(n.Component);G.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1,recordVideo:!1};var z=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={recording:[],videoRecording:[],replay:!1,front:!0,video:!0,multipose:!1,stop:!1,mode:"replay",dims:{},hideInfo:!1},a.onToggle=a.onToggle.bind(Object(h.a)(Object(h.a)(a))),a.onToggleFrontCamera=a.onToggleFrontCamera.bind(Object(h.a)(Object(h.a)(a))),a.onToggleVideoFeed=a.onToggleVideoFeed.bind(Object(h.a)(Object(h.a)(a))),a.onTracePose=a.onTracePose.bind(Object(h.a)(Object(h.a)(a))),a.onTraceVideo=a.onTraceVideo.bind(Object(h.a)(Object(h.a)(a))),a.onToggleMultiPose=a.onToggleMultiPose.bind(Object(h.a)(Object(h.a)(a))),a.onStartRecord=a.onStartRecord.bind(Object(h.a)(Object(h.a)(a))),a.onStopRecord=a.onStopRecord.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onToggle",value:function(e){this.setState({replay:!this.state.replay,mode:e})}},{key:"onToggleFrontCamera",value:function(){this.setState({front:!this.state.front})}},{key:"onToggleVideoFeed",value:function(){this.setState({video:!this.state.video})}},{key:"onToggleMultiPose",value:function(){this.setState({multipose:!this.state.multipose})}},{key:"onTracePose",value:function(e){this.setState({recording:e})}},{key:"onTraceVideo",value:function(e){this.setState({videoRecording:e})}},{key:"onStartRecord",value:function(){this.setState({record:!0})}},{key:"onStopRecord",value:function(){this.setState({record:!1})}},{key:"componentDidMount",value:function(){var e=this;this.setState({height:window.innerHeight,width:Math.min(window.innerWidth,400)}),setTimeout(function(){return e.setState({hideInfo:!0})},2e4)}},{key:"render",value:function(){var e=this,t=o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:p.a.contentDiv,style:{display:"replay"===this.state.mode?"block":"none"}},o.a.createElement(U,{videoWidth:this.state.width,videoHeight:this.state.height,poseRecords:this.state.recording,poseVideo:this.state.videoRecording,showVideo:!0,additionalOptions:!1})),"record"===this.state.mode?o.a.createElement(H,{videoWidth:this.state.width,videoHeight:this.state.height,outputStride:16,loadingText:"Loading...",frontCamera:this.state.front,getPoseRecords:this.onTracePose,getVideoRecords:this.onTraceVideo,showVideo:this.state.video,algorithm:this.state.multipose?"multi-pose":"single-pose",record:this.state.record,recordVideo:!0}):"","compete"===this.state.mode?o.a.createElement(G,{poseRecords:this.state.recording,poseVideo:this.state.videoRecording}):""),a=o.a.createElement("div",{className:p.a.toggles,style:{display:"flex",justifyContent:"space-evenly"}},o.a.createElement("button",{className:p.a.toggleButton,onClick:this.onToggleFrontCamera},this.state.front?"front":"rear"," camera"),o.a.createElement("button",{className:p.a.toggleButton,onClick:this.onToggleVideoFeed},"video ",this.state.video?"on":"off"),o.a.createElement("button",{className:p.a.toggleButton,onClick:this.onStartRecord},"start recording"),o.a.createElement("button",{className:p.a.toggleButtonRight,onClick:this.onStopRecord},"stop recording")),n=o.a.createElement("div",{style:{display:this.state.hideInfo?"none":"initial"},className:p.a.warningDiv},o.a.createElement("div",{className:p.a.warning},o.a.createElement("code",{style:{fontSize:10,color:"grey"}},"* video on/off toggle doesn't seem to work while camera is already running. please toggle between cameras to make it work."))),r=0===this.state.recording.length;return o.a.createElement("div",{className:p.a.app},o.a.createElement("div",{className:p.a.appContent},o.a.createElement("div",{className:p.a.frames,style:{color:r?"red":q,fontSize:15}},o.a.createElement("code",null,"recorded frames: ",this.state.recording.length)),o.a.createElement("div",{style:{display:"record"===this.state.mode?"flex":"none",flexDirection:"column",justifyContent:"center",alignItems:"center"}},a,n)),t,o.a.createElement(function(){return o.a.createElement("div",{className:p.a.modeButtons},o.a.createElement("div",{className:p.a.btnContainer},o.a.createElement("button",{className:p.a.btnLeft,onClick:function(){return e.onToggle("record")},style:{padding:"8px 15px",backgroundColor:0===e.state.recording.length?q:"white",color:0===e.state.recording.length?"white":"black"}},"RECORD \ud83d\udcf9"),o.a.createElement("button",{className:p.a.btnRight,onClick:function(){return e.onToggle("replay")},style:{padding:"8px 15px",backgroundColor:0!==e.state.recording.length?B:"white",color:0!==e.state.recording.length?"white":"black"}},"REPLAY \u25b6\ufe0f")))},null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t,a){e.exports={app:"App_app__2q9x4",appContent:"App_appContent__1uhZF",contentDiv:"App_contentDiv__2hIum",modeButtons:"App_modeButtons__3SEgr",frames:"App_frames__vi845",warning:"App_warning__1RHk8",warningDiv:"App_warningDiv__2taWY",toggles:"App_toggles__1x73w",toggleButton:"App_toggleButton__2MXSU",toggleButtonRight:"App_toggleButtonRight__2MklE App_toggleButton__2MXSU",btnContainer:"App_btnContainer__3AbS2",btn:"App_btn__-YolR",btnLeft:"App_btnLeft__1pgwK App_btn__-YolR",btnRight:"App_btnRight__2vLku App_btn__-YolR"}}},[[163,2,1]]]);
//# sourceMappingURL=main.10ce6df8.chunk.js.map