(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{154:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},156:function(e,t,a){e.exports=a(361)},161:function(e,t,a){},163:function(e,t,a){},170:function(e,t){},172:function(e,t){},205:function(e,t){},206:function(e,t){},361:function(e,t,a){"use strict";a.r(t);var o=a(1),n=a.n(o),r=a(153),i=a.n(r),s=(a(161),a(41)),c=a(42),l=a(46),d=a(43),f=a(45),u=a(6),h=a(154),g=a.n(h),m=(a(163),a(44)),p=a(11),b=a.n(p),v=a(31),k=a(59),y=(a(253),a(155)),w=a.n(y),C=a(95),P=a.n(C),j={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"};function x(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"undefined"!=typeof t[e.toLowerCase()]&&t[e.toLowerCase()]}var O=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1?arguments[1]:void 0,a=O(t),o=O("#333333");return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(m.a)(Array(e)).map(function(o,n){return(1-(r=n/e))*a+r*t;var r})}(e).map(function(e){return"#"+((1<<24)+((t=function(e,t,a){arguments.length<3&&(a=.5);for(var o=e.slice(),n=0;n<3;n++)o[n]=Math.round(o[n]+a*(t[n]-e[n]));return o}(a,o,e))[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1);var t}).reverse()},S=a(96),T=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},R=function(e,t,a,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.forEach(function(e){if(e.score>=t){var r=e.position,i=r.y,s=r.x;o.beginPath(),o.arc(s*n,i*n,3,0,2*Math.PI),o.fillStyle=a,o.fill()}})},A=function(e){return[e.y,e.x]},F=function(e,t,a,o,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;k.a(e,t).forEach(function(e){!function(e,t,a,o,n,r){var i=Object(S.a)(e,2),s=i[0],c=i[1],l=Object(S.a)(t,2),d=l[0],f=l[1];r.beginPath(),r.moveTo(c*n,s*n),r.lineTo(f*n,d*n),r.lineWidth=o,r.strokeStyle=a,r.stroke()}(A(e[0].position),A(e[1].position),a,o,r,n)})},D=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={loading:!0,error_messages:"",stream:null,trace:[]},a.camera=void 0,a.getCanvas=function(e){a.canvas=e},a.getVideo=function(e){a.video=e},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=Object(v.a)(b.a.mark(function e(t,a){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this.props){e.next=8;break}if(t.frontCamera===this.props.frontCamera){e.next=8;break}return this.stopCamera(),e.next=5,this.setupCamera();case 5:this.camera=e.sent,this.startCamera(),this.detectPose();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"errorMessages",value:function(){this.props.errorMessages&&this.props.errorMessages(this.state.error_messages)}},{key:"getPoseRecords",value:function(){this.props.getPoseRecords&&this.props.getPoseRecords(this.state.trace)}},{key:"tracePose",value:function(e){this.props.record&&(console.log("recording frame!"),this.setState({trace:[].concat(Object(m.a)(this.state.trace),Object(m.a)(e))}))}},{key:"stopCamera",value:function(){var e=this.camera;e&&(e.srcObject.getTracks().map(function(e){return e.stop()}),this.camera=void 0,this.setState({loading:!0,stop:!0}))}},{key:"startCamera",value:function(){this.camera?this.setState({loading:!1,stop:!1}):this.stopCamera()}},{key:"setupCamera",value:function(){var e=Object(v.a)(b.a.mark(function e(){var t,a,o,n,r,i,s,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=4;break}throw t="Browser API navigator.mediaDevices.getUserMedia not available",this.setState({error_messages:t}),t;case 4:return a=this.props,o=a.videoWidth,n=a.videoHeight,r=this.video,i=T(),s=this.props.frontCamera,r.width=o,r.height=n,e.next=12,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:s?"user":{exact:"environment"},width:i?void 0:o,height:i?void 0:n}});case 12:return c=e.sent,r.srcObject=c,e.abrupt("return",new Promise(function(e){r.onloadedmetadata=function(){r.play(),e(r)}}));case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"detectPose",value:function(){var e=this.props,t=e.videoWidth,a=e.videoHeight,o=this.canvas,n=o.getContext("2d");o.width=t,o.height=a,this.poseDetectionFrame(n)}},{key:"poseDetectionFrame",value:function(e){var t=this,a=this.props,o=a.algorithm,n=a.imageScaleFactor,r=a.forceFlipHorizontal,i=a.outputStride,s=a.minPoseConfidence,c=a.maxPoseDetections,l=a.minPartConfidence,d=a.nmsRadius,f=a.videoWidth,u=a.videoHeight,h=a.showVideo,g=a.showPoints,m=a.showSkeleton,p=a.skeletonColor,k=a.skeletonLineWidth,y=a.frontCamera,w=a.stop,C=this.net,P=this.video,j=r||!!y,x=function(){var a=Object(v.a)(b.a.mark(function a(){var r,v;return b.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=[],a.t0=o,a.next="single-pose"===a.t0?4:"multi-pose"===a.t0?9:13;break;case 4:return a.next=6,C.estimateSinglePose(P,n,j,i);case 6:return v=a.sent,r.push(v),a.abrupt("break",13);case 9:return a.next=11,C.estimateMultiplePoses(P,n,j,i,c,l,d);case 11:return r=a.sent,a.abrupt("break",13);case 13:e.clearRect(0,0,f,u),h&&(e.save(),j&&(e.scale(-1,1),e.translate(-f,0)),e.drawImage(P,0,0,f,u),e.restore()),r.forEach(function(t){var a=t.score,o=t.keypoints;a>=s&&(g&&R(o,l,p,e),m&&F(o,l,p,k,e))}),w||t.state.stop||!t.camera?(console.log("stopping function"),e.clearRect(0,0,f,u)):(console.log(r),t.tracePose(r),t.getPoseRecords(),requestAnimationFrame(x));case 17:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();x()}},{key:"componentDidMount",value:function(){var e=Object(v.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b(this.props.mobileNetArchitecture);case 2:return this.net=e.sent,console.log("loaded mobilenet"),console.log(this.net),e.prev=5,e.next=8,this.setupCamera();case 8:this.camera=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),t="This browser does not support video capture, or this device does not have a camera",this.setState({error_messages:t}),t;case 16:return e.prev=16,this.setState({loading:!1}),e.finish(16);case 19:this.detectPose();case 20:case"end":return e.stop()}},e,this,[[5,11,16,19]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("component will unmounts!"),this.stopCamera(),this.setState({stop:!0})}},{key:"render",value:function(){var e=this.state.loading?n.a.createElement("div",{className:P.a.loading},n.a.createElement("code",null,this.props.loadingText),n.a.createElement("br",null),n.a.createElement("code",{style:{color:"red",fontSize:12}},this.state.error_messages)):"";return this.errorMessages(),n.a.createElement("div",{className:P.a.posenet},e,n.a.createElement("video",{playsInline:!0,ref:this.getVideo}),n.a.createElement("canvas",{ref:this.getCanvas}))}}]),t}(o.Component);D.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:T()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1};var W=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).getCanvas=function(e){a.canvas=e},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"drawPose",value:function(){var e=this.props,t=e.videoWidth,a=e.videoHeight,o=this.canvas,n=o.getContext("2d");o.width=t,o.height=a,this.poseDrawFrame(n)}},{key:"poseDrawFrame",value:function(e){var t=this.props,a=t.minPoseConfidence,o=t.minPartConfidence,n=t.videoWidth,r=t.videoHeight,i=t.showPoints,s=t.showSkeleton,c=t.skeletonColor,l=t.skeletonLineWidth,d=this.props.poseRecords;(function(){var t=Object(v.a)(b.a.mark(function t(){var f,u,h,g;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:f=[],u=(f=d).length,h=x(c)||"#cccccc",g=E(u,h),console.log("color list"),console.log(g),e.clearRect(0,0,n,r),f.map(function(t,n){var r=t.score,c=t.keypoints;r>=a&&(i&&R(c,o,g[n],e),s&&F(c,o,g[n],l,e))});case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}})()()}},{key:"componentDidMount",value:function(){this.drawPose()}},{key:"render",value:function(){var e=this.props.poseRecords;return n.a.createElement("div",null,n.a.createElement("div",{style:{minHeight:"50vh",border:"2px solid salmon",backgroundColor:"#050517",maxWidth:800,margin:"3rem auto"}},n.a.createElement("canvas",{ref:this.getCanvas})),n.a.createElement("div",{style:{height:"100%",maxWidth:800,margin:"3rem auto",textAlign:"left",border:"1px dashed lightgrey",padding:"0 10px"}},n.a.createElement(w.a,{data:e,theme:j})))}}]),t}(o.Component);W.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:T()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1};var M=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={recording:[],replay:!1,front:!1,video:!0,multipose:!1,stop:!1},a.onToggle=a.onToggle.bind(Object(u.a)(Object(u.a)(a))),a.onToggleFrontCamera=a.onToggleFrontCamera.bind(Object(u.a)(Object(u.a)(a))),a.onToggleVideoFeed=a.onToggleVideoFeed.bind(Object(u.a)(Object(u.a)(a))),a.onTrace=a.onTrace.bind(Object(u.a)(Object(u.a)(a))),a.onToggleMultiPose=a.onToggleMultiPose.bind(Object(u.a)(Object(u.a)(a))),a.onStartRecord=a.onStartRecord.bind(Object(u.a)(Object(u.a)(a))),a.onStopRecord=a.onStopRecord.bind(Object(u.a)(Object(u.a)(a))),a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"onToggle",value:function(){this.setState({replay:!this.state.replay})}},{key:"onToggleFrontCamera",value:function(){this.setState({front:!this.state.front})}},{key:"onToggleVideoFeed",value:function(){this.setState({video:!this.state.video})}},{key:"onToggleMultiPose",value:function(){this.setState({multipose:!this.state.multipose})}},{key:"onTrace",value:function(e){this.setState({recording:e})}},{key:"onStartRecord",value:function(){this.setState({record:!0})}},{key:"onStopRecord",value:function(){this.setState({record:!1})}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",{style:{minHeight:200,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},n.a.createElement("img",{src:g.a,className:"App-logo",alt:"logo"}),n.a.createElement("br",null),n.a.createElement("div",{style:{width:"80%",display:"flex",justifyContent:"space-evenly"}},n.a.createElement("button",{onClick:this.onToggle},"toggle replay"),n.a.createElement("code",null,"recorded frames: ",this.state.recording.length)),n.a.createElement("hr",{style:{width:"100%"}}),n.a.createElement("div",{style:{width:"80%",display:"flex",justifyContent:"space-evenly"}},n.a.createElement("button",{onClick:this.onToggleFrontCamera},this.state.front?"front":"rear"," camera"),n.a.createElement("button",{onClick:this.onToggleVideoFeed},"video ",this.state.video?"on":"off"),n.a.createElement("button",{onClick:this.onToggleMultiPose},this.state.multipose?"multi-":"single ","pose"),n.a.createElement("button",{onClick:this.onStartRecord},"start recording"),n.a.createElement("button",{onClick:this.onStopRecord},"stop recording")),n.a.createElement("br",null),n.a.createElement("code",{style:{fontSize:10,color:"grey",width:"70%"}},"*video toggle and single/multipose toggles don't seem to work while camera is already running. please toggle between cameras to make it work.")),this.state.replay?n.a.createElement(D,{videoWidth:600,videoHeight:500,mobileNetArchitecture:.5,outputStride:16,loadingText:"Loading...",frontCamera:this.state.front,getPoseRecords:this.onTrace,showVideo:this.state.video,algorithm:this.state.multipose?"multi-pose":"single-pose",record:this.state.record}):n.a.createElement(W,{poseRecords:this.state.recording}))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},95:function(e,t,a){e.exports={loading:"Posenet_loading__3_Gk5",posenet:"Posenet_posenet__3mPFo"}}},[[156,2,1]]]);
//# sourceMappingURL=main.8f8d9c99.chunk.js.map