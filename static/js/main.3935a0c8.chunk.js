(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{160:function(e,t,a){e.exports={sliderScrubber:"SliderScrubber_sliderScrubber__2PdqC"}},162:function(e,t,a){e.exports=a(389)},167:function(e,t,a){},169:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},170:function(e,t,a){},177:function(e,t){},179:function(e,t){},212:function(e,t){},213:function(e,t){},26:function(e,t,a){e.exports={loading:"Posenet_loading__3_Gk5",posenet:"Posenet_posenet__3mPFo",download:"Posenet_download__3Ba3B",button:"Posenet_button__SsefG"}},385:function(e,t,a){},389:function(e,t,a){"use strict";a.r(t);var o=a(1),n=a.n(o),r=a(156),i=a.n(r),s=(a(167),a(21)),c=a(22),l=a(25),d=a(23),u=a(24),h=a(4),f=(a(169),a(170),a(18)),g=a(5),m=a.n(g),p=a(13),b=a(48),v=a(157),k=a.n(v),y=a(158),w=a.n(y),C=a(26),j=a.n(C),P={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"};function x(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"undefined"!=typeof t[e.toLowerCase()]&&t[e.toLowerCase()]}var O=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1?arguments[1]:void 0,a=O(t),o=O("#333333");return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(f.a)(Array(e)).map(function(o,n){return(1-(r=n/e))*a+r*t;var r})}(e).map(function(e){return"#"+((1<<24)+((t=function(e,t,a){arguments.length<3&&(a=.5);for(var o=e.slice(),n=0;n<3;n++)o[n]=Math.round(o[n]+a*(t[n]-e[n]));return o}(a,o,e))[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1);var t}).reverse()},E=a(98),S=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},V=function(e,t,a,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.forEach(function(e){if(e.score>=t){var r=e.position,i=r.y,s=r.x;o.beginPath(),o.arc(s*n,i*n,3,0,2*Math.PI),o.fillStyle=a,o.fill()}})},T=function(e){return[e.y,e.x]},F=function(e,t,a,o,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;b.a(e,t).forEach(function(e){!function(e,t,a,o,n,r){var i=Object(E.a)(e,2),s=i[0],c=i[1],l=Object(E.a)(t,2),d=l[0],u=l[1];r.beginPath(),r.moveTo(c*n,s*n),r.lineTo(u*n,d*n),r.lineWidth=o,r.strokeStyle=a,r.stroke()}(T(e[0].position),T(e[1].position),a,o,r,n)})},A=a(159),D=a.n(A),W=a(160),_=a.n(W),M=(a(383),a(385),function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={value:{min:10,max:50}},a.onChangeComplete=a.onChangeComplete.bind(Object(h.a)(Object(h.a)(a))),a.onChange=a.onChange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onChangeComplete",value:function(e){this.props.onChangeComplete&&this.props.onChangeComplete(e)}},{key:"onChange",value:function(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.props.range,t=e&&e.min||0,a=e&&(e.max||e)||100,o={min:Math.min(Math.max(this.state.value.min,t),a-20),max:Math.min(this.state.value.max,a)};return n.a.createElement("div",{className:_.a.sliderScrubber},n.a.createElement(D.a,{draggableTrack:!0,maxValue:a,minValue:t,onChange:this.onChange,onChangeComplete:this.onChangeComplete,value:o}))}}]),t}(o.Component)),L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json.txt",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain",o=document.createElement("a"),n=new Blob([e],{type:a});o.href=URL.createObjectURL(n),o.download=t,o.click()},N=a(161),q={subject:"subject_value",message:"message_value",from:"from_value"},H=function(){var e=Object(p.a)(m.a.mark(function e(t){var a,o,n,r;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.subject,o=t.message,n=t.from,r={subject:a,message:o,from:n},e.abrupt("return",new Promise(function(e){N.send("default_service","posenet",r||q,"user_ljTfIJFviZGfuGmui594C").then(function(t){console.log("SUCCESS!",t.status,t.text),e(!0)},function(t){console.log("FAILED...",t),e(!1)})}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),I=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={loading:!0,error_messages:"",stream:null,trace:[],frames:[]},a.camera=void 0,a.traceVideo=a.traceVideo.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a.getVideo=function(e){a.video=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){var e=Object(p.a)(m.a.mark(function e(t,a){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this.props){e.next=8;break}if(t.frontCamera===this.props.frontCamera){e.next=8;break}return this.stopCamera(),e.next=5,this.setupCamera();case 5:this.camera=e.sent,this.startCamera(),this.detectPose();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"errorMessages",value:function(){this.props.errorMessages&&this.props.errorMessages(this.state.error_messages)}},{key:"getPoseRecords",value:function(){this.props.getPoseRecords&&this.props.getPoseRecords(this.state.trace)}},{key:"getVideoRecords",value:function(){this.props.getVideoRecords&&this.props.getVideoRecords(this.state.frames)}},{key:"tracePose",value:function(e){this.props.record&&this.setState({trace:[].concat(Object(f.a)(this.state.trace),Object(f.a)(e))})}},{key:"traceVideo",value:function(e){this.props.record&&this.setState({frames:[].concat(Object(f.a)(this.state.frames),[e])})}},{key:"stopCamera",value:function(){var e=this.camera;e&&(e.srcObject.getTracks().map(function(e){return e.stop()}),this.camera=void 0,this.setState({loading:!0,stop:!0}))}},{key:"startCamera",value:function(){this.camera?this.setState({loading:!1,stop:!1}):this.stopCamera()}},{key:"setupCamera",value:function(){var e=Object(p.a)(m.a.mark(function e(){var t,a,o,n,r,i,s,c;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=4;break}throw t="Browser API navigator.mediaDevices.getUserMedia not available",this.setState({error_messages:t}),t;case 4:return a=this.props,o=a.videoWidth,n=a.videoHeight,r=this.video,i=S(),s=this.props.frontCamera,r.width=o,r.height=n,e.next=12,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:s?"user":{exact:"environment"},width:i?void 0:o,height:i?void 0:n}});case 12:return c=e.sent,r.srcObject=c,e.abrupt("return",new Promise(function(e){r.onloadedmetadata=function(){r.play(),e(r)}}));case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"detectPose",value:function(){var e=this.props,t=e.videoWidth,a=e.videoHeight,o=this.canvas,n=o.getContext("2d");o.width=t,o.height=a,this.poseDetectionFrame(n)}},{key:"poseDetectionFrame",value:function(e){var t=this,a=this.props,o=a.algorithm,n=a.imageScaleFactor,r=a.forceFlipHorizontal,i=a.outputStride,s=a.minPoseConfidence,c=a.maxPoseDetections,l=a.minPartConfidence,d=a.nmsRadius,u=a.videoWidth,h=a.videoHeight,f=a.showVideo,g=a.showPoints,b=a.showSkeleton,v=a.skeletonColor,k=a.skeletonLineWidth,y=a.frontCamera,w=a.stop,C=this.net,j=this.video,P=r||!!y,x=function(){var a=Object(p.a)(m.a.mark(function a(){var r,p;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=[],a.t0=o,a.next="single-pose"===a.t0?4:"multi-pose"===a.t0?9:13;break;case 4:return a.next=6,C.estimateSinglePose(j,n,P,i);case 6:return p=a.sent,r.push(p),a.abrupt("break",13);case 9:return a.next=11,C.estimateMultiplePoses(j,n,P,i,c,l,d);case 11:return r=a.sent,a.abrupt("break",13);case 13:e.clearRect(0,0,u,h),f&&(e.save(),P&&(e.scale(-1,1),e.translate(-u,0)),e.drawImage(j,0,0,u,h),e.restore()),r.forEach(function(t){var a=t.score,o=t.keypoints;a>=s&&(g&&V(o,l,v,e),b&&F(o,l,v,k,e))}),w||t.state.stop||!t.camera?(console.log("stopping function"),e.clearRect(0,0,u,h)):(t.props.record&&(t.props.recordVideo?console.log("recording frame and video!"):console.log("recording frames!"),t.tracePose(r),t.canvas.toBlob(t.traceVideo,"image/jpeg",.4),t.getPoseRecords(),t.getVideoRecords()),requestAnimationFrame(x));case 17:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();x()}},{key:"componentDidMount",value:function(){var e=Object(p.a)(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.b(this.props.mobileNetArchitecture);case 2:return this.net=e.sent,console.log("loaded mobilenet"),console.log(this.net),e.prev=5,e.next=8,this.setupCamera();case 8:this.camera=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),t="This browser does not support video capture, or this device does not have a camera",this.setState({error_messages:t}),t;case 16:return e.prev=16,this.setState({loading:!1}),e.finish(16);case 19:this.detectPose();case 20:case"end":return e.stop()}},e,this,[[5,11,16,19]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("component will unmounts!"),this.stopCamera(),this.setState({stop:!0})}},{key:"render",value:function(){var e=this.state.loading?n.a.createElement("div",{className:j.a.loading},n.a.createElement("code",null,this.props.loadingText),n.a.createElement("br",null),n.a.createElement("code",{style:{color:"red",fontSize:12}},this.state.error_messages)):"";return this.errorMessages(),n.a.createElement("div",{className:j.a.posenet},e,n.a.createElement("video",{playsInline:!0,ref:this.getVideo}),n.a.createElement("canvas",{ref:this.getCanvas}))}}]),t}(o.Component);I.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1,recordVideo:!1};var U=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={loadedPoseRecords:[],loadedPoseVideo:[]},a.onChange=a.onChange.bind(Object(h.a)(Object(h.a)(a))),a.loadData=a.loadData.bind(Object(h.a)(Object(h.a)(a))),a.handleFileRead=a.handleFileRead.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"drawPose",value:function(e){var t=this.props,a=t.videoWidth,o=t.videoHeight,n=this.canvas,r=n.getContext("2d");n.width=a,n.height=o,this.poseDrawFrame(r,e)}},{key:"poseDrawFrame",value:function(e,t){var a=this.props,o=a.minPoseConfidence,n=a.minPartConfidence,r=a.videoWidth,i=a.videoHeight,s=a.showPoints,c=a.showSkeleton,l=a.skeletonColor,d=a.skeletonLineWidth,u=a.showVideo,h=a.flipped,f=this.props,g=f.poseRecords,b=f.poseVideo;0===g.length&&this.state.loadedPoseRecords.length>1&&(g=this.state.loadedPoseRecords),0===b.length&&this.state.loadedPoseVideo.length>1&&(b=this.state.loadedPoseVideo),requestAnimationFrame(function(){var a=Object(p.a)(m.a.mark(function a(){var f,p,v,k,y,w,C,j;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:f=function(){p.map(function(t,a){var r=t.score,i=t.keypoints;r>=o&&(s&&V(i,n,w[a],e),c&&F(i,n,w[a],d,e))})},p=[],p=t?g.slice(t.min,t.max):g,v=[],t?(p=g.slice(t.min,t.max),b&&(v=b.slice(t.min,t.max))):(p=g,b&&(v=b)),v=v[v.length-1],k=p.length,y=x(l)||"#cccccc",(w=R(k,y)).reverse()[0]="#fff",w.reverse(),u&&b.length>1&&p.length>1?(C=document.createElement("img"),j=URL.createObjectURL(v),C.src=j,C.onload=function(){e.clearRect(0,0,r,i),e.save(),h&&(e.scale(-1,1),e.translate(-r,0)),e.drawImage(C,0,0,r,i),e.restore(),f(),URL.revokeObjectURL(j)}):(e.clearRect(0,0,r,i),f());case 12:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}())}},{key:"componentDidMount",value:function(){this.drawPose()}},{key:"onChange",value:function(e){this.drawPose(e)}},{key:"handleFileRead",value:function(e){var t=JSON.parse(this.fileReader.result);this.setState({loadedPoseRecords:t.poseRecords||t||[],loadedPoseVideo:t.poseVideo||[]})}},{key:"loadData",value:function(e){this.fileReader=new FileReader,this.fileReader.onloadend=this.handleFileRead,this.fileReader.readAsText(e.target.files[0])}},{key:"render",value:function(){var e=this,t=this.props,a=t.poseRecords,o=t.poseVideo;return 0===a.length&&this.state.loadedPoseRecords.length>1&&(a=this.state.loadedPoseRecords),0===o.length&&this.state.loadedPoseVideo.length>1&&(o=this.state.loadedPoseVideo),n.a.createElement("div",null,n.a.createElement("div",{style:{minHeight:"50vh",border:"2px solid salmon",backgroundColor:"#050517",maxWidth:800,margin:"3rem auto",overflow:"hidden"}},n.a.createElement("div",null,n.a.createElement("canvas",{ref:this.getCanvas})),n.a.createElement(M,{onChange:this.onChange,range:a.length})),a.length>1?n.a.createElement("div",null,n.a.createElement("div",{className:j.a.download,style:{maxWidth:800,margin:"0 auto",display:"flex"}},n.a.createElement("button",{className:j.a.button,onClick:function(){return L(JSON.stringify({poseRecords:a,poseVideo:[]}),"temp.json")}},"download data"),n.a.createElement("button",{className:j.a.button,onClick:Object(p.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H({subject:"GWARA GWARA!",message:"I challenge you! GAWRRR!",from:"Rahmat Hidayat"});case 2:alert("challenge sent!");case 3:case"end":return e.stop()}},e,this)}))},"send challenge"),n.a.createElement("button",{className:j.a.button,onClick:function(){return e.setState({loadedPoseRecords:[],loadedPoseVideo:[]})}},"clear data"))):n.a.createElement("div",{className:j.a.download,style:{maxWidth:800,padding:"10px 0",margin:"0 auto"}},n.a.createElement("input",{type:"file",name:"pose records upload",accept:".json",onChange:this.loadData})),n.a.createElement("div",{style:{height:"100%",maxWidth:800,margin:"3rem auto",textAlign:"left",border:"1px dashed lightgrey",padding:"0 10px"}},n.a.createElement(w.a,{data:a,theme:P})))}}]),t}(o.Component);U.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1};var B=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={loading:!0,error_messages:"",stream:null,trace:[],frames:[],height:0,width:0},a.traceVideo=a.traceVideo.bind(Object(h.a)(Object(h.a)(a))),a.getCanvas=function(e){a.canvas=e},a.getVideo=function(e){a.video=e},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"tracePose",value:function(e){this.props.record&&this.setState({trace:[].concat(Object(f.a)(this.state.trace),Object(f.a)(e))})}},{key:"traceVideo",value:function(e){this.props.record&&this.setState({frames:[].concat(Object(f.a)(this.state.frames),[e])})}},{key:"onStream",value:function(e){console.log("streaming data"),console.log(e)}},{key:"setDims",value:function(e,t){this.setState({height:e,width:t})}},{key:"detectPose",value:function(){var e=this.state,t=e.width,a=e.height,o=this.canvas,n=o.getContext("2d");o.width=t,o.height=a,this.poseDetectionFrame(n)}},{key:"poseDetectionFrame",value:function(e){var t=this,a=this.props,o=a.algorithm,n=a.imageScaleFactor,r=a.forceFlipHorizontal,i=a.outputStride,s=a.minPoseConfidence,c=a.maxPoseDetections,l=a.minPartConfidence,d=a.nmsRadius,u=a.videoWidth,h=a.videoHeight,f=a.showVideo,g=a.showPoints,b=a.showSkeleton,v=a.skeletonColor,k=a.skeletonLineWidth,y=a.frontCamera,w=a.stop,C=this.net,j=this.video,P=r||!!y,x=function(){var a=Object(p.a)(m.a.mark(function a(){var r,p;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=[],a.t0=o,a.next="single-pose"===a.t0?4:"multi-pose"===a.t0?9:13;break;case 4:return a.next=6,C.estimateSinglePose(j,n,P,i);case 6:return p=a.sent,r.push(p),a.abrupt("break",13);case 9:return a.next=11,C.estimateMultiplePoses(j,n,P,i,c,l,d);case 11:return r=a.sent,a.abrupt("break",13);case 13:e.clearRect(0,0,u,h),f&&(e.save(),P&&(e.scale(-1,1),e.translate(-u,0)),e.drawImage(j,0,0,u,h),e.restore()),r.forEach(function(t){var a=t.score,o=t.keypoints;a>=s&&(g&&V(o,l,v,e),b&&F(o,l,v,k,e))}),w||t.state.stop||!t.camera?(console.log("stopping function"),e.clearRect(0,0,u,h)):(t.props.record&&(t.props.recordVideo?console.log("recording frame and video!"):console.log("recording frames!"),t.tracePose(r),t.canvas.toBlob(t.traceVideo,"image/jpeg",.4),t.getPoseRecords(),t.getVideoRecords()),requestAnimationFrame(x));case 17:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();x()}},{key:"onCameraStart",value:function(){var e=Object(p.a)(m.a.mark(function e(t){var a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getVideoTracks()[0].getSettings(),e.next=3,b.b(this.props.mobileNetArchitecture);case 3:this.net=e.sent,this.setDims(a.height,a.width),this.onStream(t),this.detectPose();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=window.innerWidth,t=window.innerHeight;return n.a.createElement("div",null,n.a.createElement("p",null,"match"),n.a.createElement(k.a,{idealResolution:{width:e,height:t}}),n.a.createElement("canvas",{ref:this.getCanvas}))}}]),t}(o.Component);B.defaultProps={videoWidth:600,videoHeight:500,algorithm:"single-pose",mobileNetArchitecture:S()?.5:1.01,showVideo:!0,showSkeleton:!0,showPoints:!0,minPoseConfidence:.1,minPartConfidence:.5,maxPoseDetections:2,nmsRadius:20,outputStride:16,imageScaleFactor:.5,skeletonColor:"aqua",skeletonLineWidth:2,loadingText:"Loading pose detector...",frontCamera:!0,stop:!1,record:!1,recordVideo:!1};var G=function(e){function t(){var e,a;Object(s.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(n)))).state={recording:[],videoRecording:[],replay:!1,front:!1,video:!0,multipose:!1,stop:!1,mode:"compete"},a.onToggle=a.onToggle.bind(Object(h.a)(Object(h.a)(a))),a.onToggleFrontCamera=a.onToggleFrontCamera.bind(Object(h.a)(Object(h.a)(a))),a.onToggleVideoFeed=a.onToggleVideoFeed.bind(Object(h.a)(Object(h.a)(a))),a.onTracePose=a.onTracePose.bind(Object(h.a)(Object(h.a)(a))),a.onTraceVideo=a.onTraceVideo.bind(Object(h.a)(Object(h.a)(a))),a.onToggleMultiPose=a.onToggleMultiPose.bind(Object(h.a)(Object(h.a)(a))),a.onStartRecord=a.onStartRecord.bind(Object(h.a)(Object(h.a)(a))),a.onStopRecord=a.onStopRecord.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onToggle",value:function(e){this.setState({replay:!this.state.replay,mode:e})}},{key:"onToggleFrontCamera",value:function(){this.setState({front:!this.state.front})}},{key:"onToggleVideoFeed",value:function(){this.setState({video:!this.state.video})}},{key:"onToggleMultiPose",value:function(){this.setState({multipose:!this.state.multipose})}},{key:"onTracePose",value:function(e){this.setState({recording:e})}},{key:"onTraceVideo",value:function(e){console.log("tracing video"),this.setState({videoRecording:e})}},{key:"onStartRecord",value:function(){this.setState({record:!0})}},{key:"onStopRecord",value:function(){this.setState({record:!1})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"App"},n.a.createElement("div",{style:{minHeight:200,display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"column",overflow:"hidden"}},n.a.createElement("br",null),n.a.createElement("div",{style:{width:"80%",display:"flex",flexDirection:"column",justifyContent:"space-evenly"}},n.a.createElement("div",null,n.a.createElement("button",{onClick:function(){return e.onToggle("record")},style:{padding:"8px 15px",backgroundColor:0===this.state.recording.length?"salmon":"white",color:0===this.state.recording.length?"white":"black"}},"RECORD"),n.a.createElement("button",{onClick:function(){return e.onToggle("replay")},style:{padding:"8px 15px",backgroundColor:0!==this.state.recording.length?"salmon":"white",color:0!==this.state.recording.length?"white":"black"}},"REPLAY"),n.a.createElement("button",{onClick:function(){return e.onToggle("compete")},style:{padding:"8px 15px",backgroundColor:0!==this.state.recording.length?"salmon":"white",color:0!==this.state.recording.length?"white":"black"}},"COMPETE")),n.a.createElement("br",null),n.a.createElement("code",null,"recorded frames: ",this.state.recording.length)),n.a.createElement("hr",{style:{width:"100%"}}),n.a.createElement("div",{style:{display:"record"===this.state.mode?"flex":"none",flexDirection:"column",justifyContent:"center",alignItems:"center"}},n.a.createElement("div",{style:{width:"80%",display:"flex",justifyContent:"space-evenly"}},n.a.createElement("button",{onClick:this.onToggleFrontCamera},this.state.front?"front":"rear"," camera"),n.a.createElement("button",{onClick:this.onToggleVideoFeed},"video ",this.state.video?"on":"off"),n.a.createElement("button",{onClick:this.onToggleMultiPose},this.state.multipose?"multi-":"single ","pose"),n.a.createElement("button",{onClick:this.onStartRecord},"start recording"),n.a.createElement("button",{onClick:this.onStopRecord},"stop recording")),n.a.createElement("br",null),n.a.createElement("code",{style:{fontSize:10,color:"grey",width:"70%"}},"*video toggle and single/multipose toggles don't seem to work while camera is already running. please toggle between cameras to make it work."))),n.a.createElement("div",{style:{display:"replay"===this.state.mode?"block":"none"}},n.a.createElement(U,{poseRecords:this.state.recording,poseVideo:this.state.videoRecording,showVideo:!0})),"record"===this.state.mode?n.a.createElement(I,{videoWidth:600,mobileNetArchitecture:1.01,outputStride:8,loadingText:"Loading...",frontCamera:this.state.front,getPoseRecords:this.onTracePose,getVideoRecords:this.onTraceVideo,showVideo:this.state.video,algorithm:this.state.multipose?"multi-pose":"single-pose",record:this.state.record,recordVideo:!0}):"","compete"===this.state.mode?n.a.createElement(B,{poseRecords:this.state.recording,poseVideo:this.state.videoRecording}):"")}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[162,2,1]]]);
//# sourceMappingURL=main.3935a0c8.chunk.js.map